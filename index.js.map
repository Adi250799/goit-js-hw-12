{"version":3,"file":"index.js","sources":["../src/js/script.js"],"sourcesContent":["import axios from 'axios';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nconst API_KEY = '46331793-9cec4180ce0cddf1fbb8fc669';\nconst BASE_URL = 'https://pixabay.com/api/';\n\nconst form = document.querySelector('#search-form');\nconst gallery = document.querySelector('#gallery');\nconst loader = document.querySelector('#loader');\nconst loadMoreBtn = document.querySelector('#load-more');\nlet lightbox;\nlet query = '';\nlet page = 1;\nconst perPage = 40;\nlet totalHits = 0;\n\nform.addEventListener('submit', onSearch);\nloadMoreBtn.addEventListener('click', onLoadMore);\n\nasync function onSearch(event) {\n  event.preventDefault();\n  query = event.target.querySelector('#search-input').value.trim();\n\n  if (query === '') {\n    iziToast.error({\n      title: 'Error',\n      message: 'Please enter a search term!',\n    });\n    return;\n  }\n\n  clearGallery();\n  toggleLoader(true);\n  loadMoreBtn.classList.add('hidden');\n  page = 1;  // Reset paginacji\n\n  try {\n    const { data } = await fetchImages();\n    totalHits = data.totalHits;\n    if (data.hits.length === 0) {\n      iziToast.warning({\n        title: 'No results',\n        message: 'No images found. Try a different search query!',\n      });\n    } else {\n      renderGallery(data.hits);\n      lightbox = new SimpleLightbox('.gallery a', { captionsData: 'alt', captionDelay: 250 });\n      lightbox.refresh();\n      if (data.totalHits > perPage) {\n        loadMoreBtn.classList.remove('hidden');\n      }\n    }\n  } catch (error) {\n    iziToast.error({\n      title: 'Error',\n      message: 'Failed to fetch images. Please try again later.',\n    });\n  } finally {\n    toggleLoader(false);\n  }\n}\n\nasync function onLoadMore() {\n  page += 1;\n  toggleLoader(true);\n  try {\n    const { data } = await fetchImages();\n    renderGallery(data.hits, true);\n    lightbox.refresh();\n\n    const { height: cardHeight } = document\n      .querySelector('.gallery')\n      .firstElementChild.getBoundingClientRect();\n\n    window.scrollBy({\n      top: cardHeight * 2,\n      behavior: 'smooth',\n    });\n\n    if (page * perPage >= totalHits) {\n      loadMoreBtn.classList.add('hidden');\n      iziToast.info({\n        title: 'End',\n        message: \"We're sorry, but you've reached the end of search results.\",\n      });\n    }\n  } catch (error) {\n    iziToast.error({\n      title: 'Error',\n      message: 'Failed to load more images. Please try again later.',\n    });\n  } finally {\n    toggleLoader(false);\n  }\n}\n\nasync function fetchImages() {\n  const response = await axios.get(`${BASE_URL}`, {\n    params: {\n      key: API_KEY,\n      q: query,\n      image_type: 'photo',\n      orientation: 'horizontal',\n      safesearch: true,\n      page,\n      per_page: perPage,\n    },\n  });\n  return response;\n}\n\nfunction renderGallery(images, append = false) {\n  const markup = images\n    .map(\n      image => `\n      <a href=\"${image.largeImageURL}\" class=\"gallery__item\">\n        <img src=\"${image.webformatURL}\" alt=\"${image.tags}\" loading=\"lazy\" />\n        <div class=\"info\">\n          <p><b>Likes:</b> ${image.likes}</p>\n          <p><b>Views:</b> ${image.views}</p>\n          <p><b>Comments:</b> ${image.comments}</p>\n          <p><b>Downloads:</b> ${image.downloads}</p>\n        </div>\n      </a>\n    `\n    )\n    .join('');\n\n  if (append) {\n    gallery.insertAdjacentHTML('beforeend', markup);\n  } else {\n    gallery.innerHTML = markup;\n  }\n}\n\nfunction clearGallery() {\n  gallery.innerHTML = '';\n}\n\nfunction toggleLoader(isLoading) {\n  if (isLoading) {\n    loader.classList.remove('hidden');\n  } else {\n    loader.classList.add('hidden');\n  }\n}\n"],"names":["API_KEY","BASE_URL","form","gallery","loader","loadMoreBtn","lightbox","query","page","perPage","totalHits","onSearch","onLoadMore","event","iziToast","clearGallery","toggleLoader","data","fetchImages","renderGallery","SimpleLightbox","cardHeight","axios","images","append","markup","image","isLoading"],"mappings":"owBAMA,MAAMA,EAAU,qCACVC,EAAW,2BAEXC,EAAO,SAAS,cAAc,cAAc,EAC5CC,EAAU,SAAS,cAAc,UAAU,EAC3CC,EAAS,SAAS,cAAc,SAAS,EACzCC,EAAc,SAAS,cAAc,YAAY,EACvD,IAAIC,EACAC,EAAQ,GACRC,EAAO,EACX,MAAMC,EAAU,GAChB,IAAIC,EAAY,EAEhBR,EAAK,iBAAiB,SAAUS,CAAQ,EACxCN,EAAY,iBAAiB,QAASO,CAAU,EAEhD,eAAeD,EAASE,EAAO,CAI7B,GAHAA,EAAM,eAAc,EACpBN,EAAQM,EAAM,OAAO,cAAc,eAAe,EAAE,MAAM,OAEtDN,IAAU,GAAI,CAChBO,EAAS,MAAM,CACb,MAAO,QACP,QAAS,6BACf,CAAK,EACD,MACD,CAEDC,IACAC,EAAa,EAAI,EACjBX,EAAY,UAAU,IAAI,QAAQ,EAClCG,EAAO,EAEP,GAAI,CACF,KAAM,CAAE,KAAAS,CAAI,EAAK,MAAMC,IACvBR,EAAYO,EAAK,UACbA,EAAK,KAAK,SAAW,EACvBH,EAAS,QAAQ,CACf,MAAO,aACP,QAAS,gDACjB,CAAO,GAEDK,EAAcF,EAAK,IAAI,EACvBX,EAAW,IAAIc,EAAe,aAAc,CAAE,aAAc,MAAO,aAAc,GAAG,CAAE,EACtFd,EAAS,QAAO,EACZW,EAAK,UAAYR,GACnBJ,EAAY,UAAU,OAAO,QAAQ,EAG1C,MAAe,CACdS,EAAS,MAAM,CACb,MAAO,QACP,QAAS,iDACf,CAAK,CACL,QAAY,CACRE,EAAa,EAAK,CACnB,CACH,CAEA,eAAeJ,GAAa,CAC1BJ,GAAQ,EACRQ,EAAa,EAAI,EACjB,GAAI,CACF,KAAM,CAAE,KAAAC,CAAI,EAAK,MAAMC,IACvBC,EAAcF,EAAK,KAAM,EAAI,EAC7BX,EAAS,QAAO,EAEhB,KAAM,CAAE,OAAQe,CAAU,EAAK,SAC5B,cAAc,UAAU,EACxB,kBAAkB,sBAAqB,EAE1C,OAAO,SAAS,CACd,IAAKA,EAAa,EAClB,SAAU,QAChB,CAAK,EAEGb,EAAOC,GAAWC,IACpBL,EAAY,UAAU,IAAI,QAAQ,EAClCS,EAAS,KAAK,CACZ,MAAO,MACP,QAAS,4DACjB,CAAO,EAEJ,MAAe,CACdA,EAAS,MAAM,CACb,MAAO,QACP,QAAS,qDACf,CAAK,CACL,QAAY,CACRE,EAAa,EAAK,CACnB,CACH,CAEA,eAAeE,GAAc,CAY3B,OAXiB,MAAMI,EAAM,IAAI,GAAGrB,CAAQ,GAAI,CAC9C,OAAQ,CACN,IAAKD,EACL,EAAGO,EACH,WAAY,QACZ,YAAa,aACb,WAAY,GACZ,KAAAC,EACA,SAAUC,CACX,CACL,CAAG,CAEH,CAEA,SAASU,EAAcI,EAAQC,EAAS,GAAO,CAC7C,MAAMC,EAASF,EACZ,IACCG,GAAS;AAAA,iBACEA,EAAM,aAAa;AAAA,oBAChBA,EAAM,YAAY,UAAUA,EAAM,IAAI;AAAA;AAAA,6BAE7BA,EAAM,KAAK;AAAA,6BACXA,EAAM,KAAK;AAAA,gCACRA,EAAM,QAAQ;AAAA,iCACbA,EAAM,SAAS;AAAA;AAAA;AAAA,KAI3C,EACA,KAAK,EAAE,EAENF,EACFrB,EAAQ,mBAAmB,YAAasB,CAAM,EAE9CtB,EAAQ,UAAYsB,CAExB,CAEA,SAASV,GAAe,CACtBZ,EAAQ,UAAY,EACtB,CAEA,SAASa,EAAaW,EAAW,CAC3BA,EACFvB,EAAO,UAAU,OAAO,QAAQ,EAEhCA,EAAO,UAAU,IAAI,QAAQ,CAEjC"}